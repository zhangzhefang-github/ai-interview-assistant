# ä¼˜å…ˆä½¿ç”¨ venv
if [[ -d ".venv" ]]; then
    echo "ğŸ’¡ Activating local .venv environment..."
    # å¦‚æœå·²å­˜åœ¨ condaï¼Œå…ˆé€€å‡º
    if [[ -n "$CONDA_DEFAULT_ENV" ]]; then
        echo "âš ï¸  Exiting conda environment $CONDA_DEFAULT_ENV before activating .venv"
        conda deactivate
    fi
    source .venv/bin/activate
    export VIRTUAL_ENV_PROMPT=$(basename "${VIRTUAL_ENV}")
elif [[ -f ".conda-env" ]]; then
    ENV_NAME=$(cat .conda-env | tr -d '[:space:]')
    if [[ -n "$ENV_NAME" ]]; then
        echo "ğŸ’¡ Activating conda environment: $ENV_NAME"
        if [[ -n "$VIRTUAL_ENV" ]]; then
            echo "âš ï¸  Exiting venv environment before activating conda"
            deactivate
        fi
        use_conda "$ENV_NAME"
        export VIRTUAL_ENV_PROMPT="$ENV_NAME"
    else
        echo "âš ï¸  .conda-env æ–‡ä»¶å­˜åœ¨ä½†ä¸ºç©ºï¼Œè·³è¿‡ conda æ¿€æ´»"
    fi
else
    echo "â„¹ï¸  No .venv or .conda-env found. Using system Python."
fi
